<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content=Dewey.Amer><link href=../../../../2024/01/31/%E6%BC%AB%E8%B0%88gptrag/ rel=next><link rel=icon href=../../../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.21"><title>RAG-Survey - What's wrong with you?</title><link rel=stylesheet href=../../../../../assets/stylesheets/main.2a3383ac.min.css><link rel=stylesheet href=../../../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#rag-survey class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../../.. title="What's wrong with you?" class="md-header__button md-logo" aria-label="What's wrong with you?" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> What's wrong with you? </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> RAG-Survey </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../../.. class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../../../ class=md-tabs__link> Blog </a> </li> <li class=md-tabs__item> <a href=../../../../../photography/ class=md-tabs__link> Photography </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation hidden> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../../.. title="What's wrong with you?" class="md-nav__button md-logo" aria-label="What's wrong with you?" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> What's wrong with you? </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__container"> <a href=../../../../ class="md-nav__link "> <span class=md-ellipsis> Blog </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex> <span class=md-ellipsis> Archive </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Archive </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../archive/2025/ class=md-nav__link> <span class=md-ellipsis> 2025 </span> </a> </li> <li class=md-nav__item> <a href=../../../../archive/2024/ class=md-nav__link> <span class=md-ellipsis> 2024 </span> </a> </li> <li class=md-nav__item> <a href=../../../../archive/2023/ class=md-nav__link> <span class=md-ellipsis> 2023 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex> <span class=md-ellipsis> Categories </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Categories </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../category/conversations/ class=md-nav__link> <span class=md-ellipsis> Conversations </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/embedding/ class=md-nav__link> <span class=md-ellipsis> Embedding </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/python/ class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/rag/ class=md-nav__link> <span class=md-ellipsis> RAG </span> </a> </li> <li class=md-nav__item> <a href=../../../../category/sociology/ class=md-nav__link> <span class=md-ellipsis> Sociology </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../../photography/ class=md-nav__link> <span class=md-ellipsis> Photography </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#preprocess-data-stage class=md-nav__link> <span class=md-ellipsis> Preprocess data stage </span> </a> <nav class=md-nav aria-label="Preprocess data stage"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#text-split class=md-nav__link> <span class=md-ellipsis> Text split </span> </a> </li> <li class=md-nav__item> <a href=#chunks class=md-nav__link> <span class=md-ellipsis> Chunks增强 </span> </a> </li> <li class=md-nav__item> <a href=#embedding class=md-nav__link> <span class=md-ellipsis> Embedding </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#retrieval-stage class=md-nav__link> <span class=md-ellipsis> Retrieval stage </span> </a> <nav class=md-nav aria-label="Retrieval stage"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#hybrid-search class=md-nav__link> <span class=md-ellipsis> Hybrid search </span> </a> <nav class=md-nav aria-label="Hybrid search"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#rrf class=md-nav__link> <span class=md-ellipsis> RRF </span> </a> </li> <li class=md-nav__item> <a href=#analysis-of-fusion-functions-for-hybrid-retrieval class=md-nav__link> <span class=md-ellipsis> Analysis of fusion functions for hybrid retrieval </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#llm class=md-nav__link> <span class=md-ellipsis> LLM </span> </a> <nav class=md-nav aria-label=LLM> <ul class=md-nav__list> <li class=md-nav__item> <a href=#query-transformation class=md-nav__link> <span class=md-ellipsis> Query transformation </span> </a> </li> <li class=md-nav__item> <a href=#recall-datapromptllm class=md-nav__link> <span class=md-ellipsis> Recall data如何在prompt组织以及如何与LLM交互 </span> </a> <nav class=md-nav aria-label="Recall data如何在prompt组织以及如何与LLM交互"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#exploring-the-integration-strategies-of-retriever-and-large-language-models class=md-nav__link> <span class=md-ellipsis> Exploring the Integration Strategies of Retriever and Large Language Models </span> </a> </li> <li class=md-nav__item> <a href=#freshllms class=md-nav__link> <span class=md-ellipsis> Freshllms </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#benchmark class=md-nav__link> <span class=md-ellipsis> Benchmark </span> </a> </li> <li class=md-nav__item> <a href=#reference class=md-nav__link> <span class=md-ellipsis> Reference </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content md-content--post" data-md-component=content> <div class="md-sidebar md-sidebar--post" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class="md-sidebar__inner md-post"> <nav class="md-nav md-nav--primary"> <div class=md-post__back> <div class="md-nav__title md-nav__container"> <a href=../../../../ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> <span class=md-ellipsis> Back to index </span> </a> </div> </div> <div class="md-post__authors md-typeset"> <div class="md-profile md-post__profile"> <span class="md-author md-author--long"> <img src=https://github.com/deweyamer.png alt=Dewey> </span> <span class=md-profile__description> <strong> Dewey </strong> <br> Creator </span> </div> </div> <ul class="md-post__meta md-nav__list"> <li class="md-nav__item md-nav__item--section"> <div class=md-post__title> <span class=md-ellipsis> Metadata </span> </div> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg> <time datetime="2023-11-11 00:00:00+00:00" class=md-ellipsis>November 11, 2023</time> </div> </li> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"/></svg> <span class=md-ellipsis> in <a href=../../../../category/rag/ >RAG</a></span> </div> </li> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg> <span class=md-ellipsis> 15 min read </span> </div> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <article class="md-content__inner md-typeset"> <h1 id=rag-survey>RAG-Survey<a class=headerlink href=#rag-survey title="Permanent link">&para;</a></h1> <p><img alt="Abstract of RAG.png" src=../../../../RAG-Survey-docs/Abstract_of_RAG.png></p> <p>为了便于理解整体逻辑，只画出了一些核心步骤，粗略分为3部分：</p> <ul> <li>Preprocess data stage: 这个阶段需要我们将外部数据进行处理，这里列举了两种方式：<ol> <li>构建索引，便于后续进行倒排检索；</li> <li>构建vector store，这里常见的问题是数据的长度可能很长，需要根据一些规则和语义进行语句或者段落的切分，称之为chunks，然后将chunks编码为embedding，存储至vector store。</li> </ol> </li> <li>Retrieval stage: 基于用户query进行检索，目的是在prompt引入召回的相关文档，减少大模型幻觉以及产生错误答案，基于上述构建的两种方式进行检索。</li> <li>LLM stage: 基于用户query和召回的相关文档构建prompt，送入LLM，产生最终的回答</li> </ul> <!-- more --> <h2 id=preprocess-data-stage>Preprocess data stage<a class=headerlink href=#preprocess-data-stage title="Permanent link">&para;</a></h2> <h3 id=text-split>Text split<a class=headerlink href=#text-split title="Permanent link">&para;</a></h3> <p>处理数据的第一步就是要做文本切分，大部分情况下，长文本数据都需要切分成以语义为单位的块，但是如何切分成语义为单位的块，现阶段没有一个较为完美的解决方案，Langchain中提供了一些文本切分的方案，其中常用的是Recursively split by character，MarkdownHeaderTextSplitter，HTMLHeaderTextSplitter。除此之外，正则表达式切分也是常用的方式。</p> <ul> <li>依据语义进行切分，使用各种方式吧，总能切成满意的语义单位的chunks，召回的时候就是召回chunks</li> <li>切分成chunks后，然后依据句子level进行切分，做成一个key-val映射的这么一个形式。</li> </ul> <h3 id=chunks>Chunks增强<a class=headerlink href=#chunks title="Permanent link">&para;</a></h3> <p>知识增强一般是指，根据上下文重新 Refine 原始的文本使得原始的文本信息更完整，自解释性更强。这个过程由于是离线的一次性处理，所以这里可以借助能力更强的商用 LLM 模型，生成的内容可能会更好。另外由于现在的 LLM 能支撑的上下文 context 长度很长，建议在生成的过程中，在 prompt 中去融入一些该场景的丰富背景信息。</p> <p><img alt=practice-of-knowledge-question-answering-application-based-on-llm-knowledge-base-construction-part-41.png src=../../../../RAG-Survey-docs/practice-of-knowledge-question-answering-application-based-on-llm-knowledge-base-construction-part-41.png></p> <p>通过知识增强，可以把文本文档也转化成 FAQ 的形式，使得对于一般的文档也能够同时进行 QQ 和 QD 召回。但这里需要注意的是，对于特别垂直的领域，能力很强的商业 LLM 也可能无法提取出比较合适的问题，一般观察到的现象是提取出的问题过于直接，或者提取出的问题无实际意义，这部分建议走一遍人工审核。</p> <p>对于质量不高的 FAQ，特别是提问过于简略的，知识增强也能够优化其质量。另外经过优化后的知识，在 LLM 生成阶段，对于提升 LLM 对知识的理解也是有一定帮助的。总的来说，知识增强是简单有效的优化手段。</p> <p>可以假设50个长度能够提取一个有效的问题，那么依据文本长度可以生成可变的问题数量，生成问题后，还可以对问题进行增强，生成更多样的提问。</p> <h3 id=embedding>Embedding<a class=headerlink href=#embedding title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>embedding name</th> <th>tokenizer</th> <th>最大输入token数</th> <th>输出维度</th> </tr> </thead> <tbody> <tr> <td>text-embedding-ada-002</td> <td>cl100k_base</td> <td>8191</td> <td>1536</td> </tr> <tr> <td>bge-large-zh</td> <td>-</td> <td>512</td> <td>1024</td> </tr> </tbody> </table> <p>在我们的QA任务中，使用了上述2个embedding模型，由于bge只有512的长度，对于编码整个QA context是不现实的，在实验中，只编码了Question，对比效果，依旧是OpenAI embedding的效果要好，而编码QA context要比单独编码question的效果好。评估指标选择nDCG@3，覆盖率。</p> <h2 id=retrieval-stage>Retrieval stage<a class=headerlink href=#retrieval-stage title="Permanent link">&para;</a></h2> <p>对于召回阶段，使用text-embedding-ada-002模型以及ElasticSearch，分别对单检索和混合检索进行实验对比，分别对bm25，knn和RRF作对比，评估指标选取nDCG@3，RRF&gt;bm25&gt;knn，但是bm25和knn的差距不大。</p> <h3 id=hybrid-search>Hybrid search<a class=headerlink href=#hybrid-search title="Permanent link">&para;</a></h3> <h4 id=rrf><a href=https://plg.uwaterloo.ca/~gvcormac/cormacksigir09-rrf.pdf>RRF</a><a class=headerlink href=#rrf title="Permanent link">&para;</a></h4> <div class=arithmatex>\[ RRFScore(d \in D) = \sum_{r \in R} \frac{1}{k+r(d)} \]</div> <p>其中k为一个参数，默认设置为60，r(d)为当前排序的idx(从1开始)，RRF只考虑每次排序的位置，丢弃了排序中数据对应的分数。在实际的使用效果来看，RRF比单独的lexical search和单独的semantic search的效果要好。</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=k>def</span><span class=w> </span><span class=nf>reciprocal_rank_fusion</span><span class=p>(</span><span class=n>search_results_dict</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mi>60</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>    <span class=n>fused_scores</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Initial individual search result ranks:&quot;</span><span class=p>)</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>    <span class=k>for</span> <span class=n>query</span><span class=p>,</span> <span class=n>doc_scores</span> <span class=ow>in</span> <span class=n>search_results_dict</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;For query &#39;</span><span class=si>{</span><span class=n>query</span><span class=si>}</span><span class=s2>&#39;: </span><span class=si>{</span><span class=n>doc_scores</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>    <span class=k>for</span> <span class=n>query</span><span class=p>,</span> <span class=n>doc_scores</span> <span class=ow>in</span> <span class=n>search_results_dict</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>        <span class=k>for</span> <span class=n>rank</span><span class=p>,</span> <span class=p>(</span><span class=n>doc</span><span class=p>,</span> <span class=n>score</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=nb>sorted</span><span class=p>(</span><span class=n>doc_scores</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)):</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>            <span class=k>if</span> <span class=n>doc</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>fused_scores</span><span class=p>:</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>                <span class=n>fused_scores</span><span class=p>[</span><span class=n>doc</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>            <span class=n>previous_score</span> <span class=o>=</span> <span class=n>fused_scores</span><span class=p>[</span><span class=n>doc</span><span class=p>]</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>            <span class=n>fused_scores</span><span class=p>[</span><span class=n>doc</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span> <span class=o>/</span> <span class=p>(</span><span class=n>rank</span> <span class=o>+</span> <span class=n>k</span><span class=p>)</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Updating score for </span><span class=si>{</span><span class=n>doc</span><span class=si>}</span><span class=s2> from </span><span class=si>{</span><span class=n>previous_score</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>fused_scores</span><span class=p>[</span><span class=n>doc</span><span class=p>]</span><span class=si>}</span><span class=s2> based on rank </span><span class=si>{</span><span class=n>rank</span><span class=si>}</span><span class=s2> in query &#39;</span><span class=si>{</span><span class=n>query</span><span class=si>}</span><span class=s2>&#39;&quot;</span><span class=p>)</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>    <span class=n>reranked_results</span> <span class=o>=</span> <span class=p>{</span><span class=n>doc</span><span class=p>:</span> <span class=n>score</span> <span class=k>for</span> <span class=n>doc</span><span class=p>,</span> <span class=n>score</span> <span class=ow>in</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>fused_scores</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)}</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Final reranked results:&quot;</span><span class=p>,</span> <span class=n>reranked_results</span><span class=p>)</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>    <span class=k>return</span> <span class=n>reranked_results</span>
</span></code></pre></div> <h4 id=analysis-of-fusion-functions-for-hybrid-retrieval><a href=https://arxiv.org/pdf/2210.11934v2.pdf>Analysis of fusion functions for hybrid retrieval</a><a class=headerlink href=#analysis-of-fusion-functions-for-hybrid-retrieval title="Permanent link">&para;</a></h4> <p>主要对convex combination(其实就是权重加和，要求权重和为1)和RRF做了实验分析，其中实验验证了RRF对于参数敏感，而在少量样本做监督微调后，convex combination的检索方式要优于RRF。</p> <p><strong>Analysis of convex combination</strong></p> <p>对于两个不同检索方式得到的召回数据，分数范围不一致，一个比较直接的想法就是对分数做归一化，然后把归一化后的数据做权重加和，得到最终分数。其中该部分内容对为什么混合检索有效以及归一化最优方式做了实验分析。</p> <p>将正负样本的lexical search分数和semantic search分数计算并归一化，得到下图，观察可以看到正负样本在散点图是有相对清晰的簇形成的，虽然这里的任务是进行排序，但是从散点图，也可以观察到正负样本在lexical search和semantic search的分数是有一定的规律的。</p> <p><img alt=fig1.PNG src=../../../../RAG-Survey-docs/fig1.png></p> <p>在论文实验中最优的归一化方式为Theoretical min-max scaling，其中对于BM25的理想下界是0，对于余弦相似度的理想下界是-1</p> <div class=arithmatex>\[ \phi_{TMM}(f_o(q,d))=\frac{f_o(q,d)-\mathrm{inf} f_o(q,\cdot)}{M_q-\mathrm{inf} f_o(q,\cdot)} \]</div> <p><strong>Analysis of RRF</strong></p> <p>在实验中，以NDCG和Recall为指标，RRF比单独的lexical search和单独的semantic search的效果要好，但是没有convex combination的效果好，与我自己实际使用的效果一致。</p> <p>RRF存在两个问题：</p> <ul> <li>RRF只是对召回的topk数据的顺序进行近似排序计算，并有真正的对数据顺序计算。(lexical和semantic召回的数据并不总是一样，只存在其中之一的数据，在另一路召回没有对应的分数)</li> <li>RRF只关注topk数据的位置，忽略了真实分数以及分布信息。</li> </ul> <p>RRF的公式如下，其中<span class=arithmatex>\(\eta\)</span>默认为60。</p> <div class=arithmatex>\[ f_{\mathrm{RRF} }(q,d)=\frac{1}{\eta + \pi _{\mathrm{LEX} }(q,d)} +\frac{1}{\eta + \pi _{\mathrm{SEM} }(q,d)} \]</div> <p>RRF用位置信息替换掉了分数信息，这样的设定是否合理以及<span class=arithmatex>\(\eta\)</span>的大小是否影响RRF的效果，是否能在各个都适用，需要在各个数据集进行验证。假设<span class=arithmatex>\(\eta \rightarrow \infty\)</span>，那么RRF的值会坍缩为一个点。假设<span class=arithmatex>\(\eta=60\)</span>，我们在不同的数据集上画出lexical和semantic召回数据的正负样本，红色为正，黑色为负，可以看到正样本倾向于聚集在(1/61,1/61)，而负样本倾向于聚集在(0,0)，但是HotpotQA和FEVER数据集看到部分正样本也汇聚于(0,0)，这就表明当<span class=arithmatex>\(\eta=60\)</span>的情况下，在不同数据集泛化能力是值得商榷的。</p> <p><img alt="Screenshot 2023-11-10 at 22.54.42.png" src=../../../../RAG-Survey-docs/Screenshot_2023-11-10_at_22.54.42.png></p> <p>那么我们对不同的召回参数化<span class=arithmatex>\(\eta\)</span>时，看看会发生什么？</p> <div class=arithmatex>\[ f_{\mathrm{RRF} }(q,d)=\frac{1}{\eta_{\mathrm{LEX}} + \pi _{\mathrm{LEX} }(q,d)} +\frac{1}{\eta_{\mathrm{SEM}} + \pi _{\mathrm{SEM} }(q,d)} \]</div> <p>从下图可以看到，当<span class=arithmatex>\(\eta_{\mathrm{LEX}}\)</span>和<span class=arithmatex>\(\eta_{\mathrm{SEM}}\)</span>变化一致时，NDCG指标的变化是负相关的，这进一步表明RRF对于不同数据集的泛化能力较差。</p> <p><img alt="Screenshot 2023-11-10 at 23.10.56.png" src=../../../../RAG-Survey-docs/Screenshot_2023-11-10_at_23.10.56.png></p> <p>对于分数以及分部信息是否有作用，作者利用了Lipschitz continuity将原始RRF近似成了SRRF(Lipschitz continuity保证了该函数不会由于输入的微小扰动导致输出的剧烈变动，作者称之为该函数具备保留信息的能力，用满足Lipschitz continuity的函数来模拟分数以及其分布)。</p> <div class=arithmatex>\[ f_{\mathrm{RRF} }(q,d)=\frac{1}{\eta + \hat{\pi} _{\mathrm{LEX} }(q,d)} +\frac{1}{\eta + \hat{\pi} _{\mathrm{SEM} }(q,d)} \]</div> <div class=arithmatex>\[ \hat{\pi_o}(q,d_i)=0.5+\sum_{d_j \in R^k_o(q)} \sigma_{\beta}(f_o(q,d_j)-f_o(q,d_i)) \]</div> <div class=arithmatex>\[ \sigma_{\beta}(x)=\frac{1}{1+e^{-\beta x}} \]</div> <p>当<span class=arithmatex>\(\beta=1\)</span>时，<span class=arithmatex>\(\sigma_{\beta}(x)\)</span>就是Sigmoid函数，<span class=arithmatex>\(\sigma_{\beta}(x)\)</span>的Lipschitz常数为<span class=arithmatex>\(\beta\)</span>，对于<span class=arithmatex>\(\hat{\pi_o}(q,d_i)\)</span>就是近似计算idx的函数</p> <p>在<span class=arithmatex>\(\beta \sim \infty\)</span>时，当<span class=arithmatex>\(f_o(q,d_j)-f_o(q,d_i) \gt 0\)</span>，<span class=arithmatex>\(\sigma_{\beta}(f_o(q,d_j)-f_o(q,d_i)) \simeq 1\)</span></p> <p>当<span class=arithmatex>\(f_o(q,d_j)-f_o(q,d_i) \gt 0\)</span>，<span class=arithmatex>\(\sigma_{\beta}(f_o(q,d_j)-f_o(q,d_i)) \simeq 0\)</span></p> <p>当<span class=arithmatex>\(f_o(q,d_j)-f_o(q,d_i) = 0\)</span>，<span class=arithmatex>\(\sigma_{\beta}(f_o(q,d_j)-f_o(q,d_i)) =0.5\)</span></p> <p>当<span class=arithmatex>\(\beta=1\)</span>和100时，<span class=arithmatex>\(\sigma_{\beta}(x)\)</span>图形如下</p> <p><img alt="desmos-graph (3).png" src=../../../../RAG-Survey-docs/desmos-graph_%283%29.png></p> <p><img alt="desmos-graph (2).png" src=../../../../RAG-Survey-docs/desmos-graph_%282%29.png></p> <p>当β太小时，近似误差很大，排名质量会下降。随着β变得越来越大，排名质量趋近于RRF。有趣的是，随着β逐渐变小，SRRF的性能比RRF更好。这种情况在RRF的η = 60设置以及其他数据集上更明显。</p> <p><img alt="Screenshot 2023-11-11 at 00.07.03.png" src=../../../../RAG-Survey-docs/Screenshot_2023-11-11_at_00.07.03.png></p> <p>作者最后对上述实验做了总结：</p> <ul> <li>单调性：组合后的hybrid function具备单调性</li> <li>同质性：数据在归一化前后顺序不变</li> <li>边界性：如果分数的范围是不确定，需要做归一化，固定边界</li> <li>Lipschitz连续性：由于RRF不考虑原始分数，扭曲了数据的分布，从而丢失了有价值的信息。从实验来看，Lipschitz constant越大，检索分数的分布更为扭曲。</li> </ul> <h2 id=llm>LLM<a class=headerlink href=#llm title="Permanent link">&para;</a></h2> <h3 id=query-transformation>Query transformation<a class=headerlink href=#query-transformation title="Permanent link">&para;</a></h3> <p>对于用户发送来的query，可以有如下几种方式对其处理</p> <ul> <li>由于用户query存在部分口语化的词，如停用词等，直接抽取用户query中的关键词做召回是一个有效的方式，ChatLaw采用了这种方式。</li> <li>生成多个queries，单个query可能无法捕获用户感兴趣的全部范围，或者它可能太窄而无法产生全面的结果。RAG-fusion中采用了这种方式。<ul> <li>queries与RRF的结合，与机器学习中的bagging方法类似，当语义一致的queries，通过不同的召回方式召回数据，并用RRF做排序，此时高相关的数据被召回的概率增加，从而提高了总体的召回效果。</li> </ul> </li> </ul> <h3 id=recall-datapromptllm>Recall data如何在prompt组织以及如何与LLM交互<a class=headerlink href=#recall-datapromptllm title="Permanent link">&para;</a></h3> <h4 id=exploring-the-integration-strategies-of-retriever-and-large-language-models>Exploring the Integration Strategies of Retriever and Large Language Models<a class=headerlink href=#exploring-the-integration-strategies-of-retriever-and-large-language-models title="Permanent link">&para;</a></h4> <p>针对召回数据送入大模型的策略进行分析</p> <p><img alt=fig1.PNG src=../../../../RAG-Survey-docs/fig1%201.png></p> <p>有两种将召回数据送入LLM的策略，Concatenation和Post-fusion。从上图可以观察到，相比Post-fusion，Concatenation出现unknown的比例远高于Post-fusion(出现unknown的意思是基于召回数据没法给出答案)；而Post-fusion虽然出现unknown的比例很低，但是随着passages的数量逐渐增多，从answer-pool选错的比例也越来越大。</p> <p><img alt=fig2.PNG src=../../../../RAG-Survey-docs/fig2.png></p> <p>本文提出了two-stage的方法</p> <ul> <li>concat+PF（先组合召回数据送入LLM回答，若无答案则分别组合召回数据送入LLM，最后选取一个答案输出）</li> <li>PF+concat（分别组合召回数据送入LLM，过滤掉输出unknown对应的数据，将剩余数据concat送入LLM得到答案）</li> </ul> <p><img alt=fig3.PNG src=../../../../RAG-Survey-docs/fig3.png></p> <p><img alt=fig4.PNG src=../../../../RAG-Survey-docs/fig4.png></p> <p>从实验和token使用量来看，concat+PF是最推荐使用的。</p> <p><img alt=fig5.PNG src=../../../../RAG-Survey-docs/fig5.png></p> <p>作者还对gold passage的位置做了实验分析，他们的prompt格式如下，当gold passage位于<code>{retrieved_context}</code>的开头和末尾的效果要好于不调整位置，其中位于末尾的时候比位于开头的效果要好，作者说可能是因为末尾与<code>{question}</code>更接近，这样会有更好的效果。还有一篇论文研究内容类似Lost in the Middle: How Language Models Use Long Contexts，它认为需要将重要的内容放在prompt的开头和结尾。</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># instruction</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=c1># few-shot example</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=c1># {retrieved_context}</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=c1># {question}</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=c1># Answer</span>
</span></code></pre></div> <h4 id=freshllms>Freshllms<a class=headerlink href=#freshllms title="Permanent link">&para;</a></h4> <p>重点关注freshprompt怎么写</p> <p><img alt="Screenshot 2023-11-19 at 10.47.56.png" src=../../../../RAG-Survey-docs/Screenshot_2023-11-19_at_10.47.56.png></p> <h2 id=benchmark>Benchmark<a class=headerlink href=#benchmark title="Permanent link">&para;</a></h2> <ol> <li><a href=https://arxiv.org/pdf/2309.15217.pdf>RAGAS: Automated Evaluation of Retrieval Augmented Generation</a></li> <li><a href=https://arxiv.org/pdf/2309.01431.pdf>Benchmarking Large Language Models in Retrieval-Augmented Generation</a></li> </ol> <h2 id=reference>Reference<a class=headerlink href=#reference title="Permanent link">&para;</a></h2> <ol> <li><a href=https://www.elastic.co/guide/en/elasticsearch/reference/current/rrf.html>https://www.elastic.co/guide/en/elasticsearch/reference/current/rrf.html</a></li> <li><a href=https://www.elastic.co/cn/blog/improving-information-retrieval-elastic-stack-hybrid>https://www.elastic.co/cn/blog/improving-information-retrieval-elastic-stack-hybrid</a></li> <li><a href=https://python.langchain.com/docs/modules/data_connection/document_transformers/ >https://python.langchain.com/docs/modules/data_connection/document_transformers/</a></li> <li><a href=https://github.com/Raudaschl/rag-fusion>https://github.com/Raudaschl/rag-fusion</a></li> <li><a href=https://github.com/PKU-YuanGroup/ChatLaw>https://github.com/PKU-YuanGroup/ChatLaw</a></li> <li><a href=https://arxiv.org/pdf/2005.11401.pdf>Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks</a></li> </ol> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 ~ now | Dewey Amer </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../../../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.expand", "navigation.indexes", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../../../assets/javascripts/bundle.f55a23d4.min.js></script> <script src=../../../../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>